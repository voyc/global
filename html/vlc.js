voyc.Animator=function(){this.fps=64;this.callback;this.mpf=0;this.playing=false};voyc.Animator.prototype={start:function(){if(this.playing){return}this.playing=true;this.setFps();this.loop()},stop:function(){if(!this.playing){return}this.playing=false},setFps:function(a){if(a){this.fps=a}this.mpf=parseInt(1000/this.fps)},loop:function(){if(this.playing){this.callback();var a=this;setTimeout(function(){a.loop()},this.mpf)}else{this.playing=false}}};voyc.Card=function(){this.zIndex=1;this.cards={};this.className="voyc-card";this.defaultOptions={top:"100px",left:"100px",className:null,draggable:true,content:"Lipsum dorum hokum.",id:"mypopup",title:"Title",parentNode:document.body,closeOnBlur:false,hasHandle:true,hasCloseButton:true}};voyc.Card.prototype.create=function(f){var g=voyc.mergeOptions(this.defaultOptions,f);if(!g.parentNode){g.parentNode=document.body}var k=document.createElement("div");k.id=g.id;k.className=this.className;if(g.className){voyc.addClass(k,g.className)}k.style.top=g.top;k.style.left=g.left;k.style.zIndex=this.zIndex++;g.parentNode.appendChild(k);if(g.hasHandle){var j=document.createElement("div");j.id=g.id+"-handle";j.className=this.className+"-handle";if(g.className){voyc.addClass(j,g.className+"-handle")}j.innerHTML=g.title;k.appendChild(j)}if(g.hasCloseButton){var a=document.createElement("button");a.id=g.id+"-closebtn";a.className=this.className+"-closebtn";if(g.className){voyc.addClass(a,g.className+"-closebtn")}a.innerHTML="X";voyc.addEvent(a,"click",function(){k.style.display="none"});k.appendChild(a)}var l=document.createElement("div");l.id=g.id+"-content";l.className=this.className+"-content";if(g.className){voyc.addClass(l,g.className+"-content")}l.innerHTML=g.content;k.appendChild(l);if(g.draggable&&voyc.dragger){voyc.dragger.enableDrag(k,j);var d=this;voyc.dragger.addListener(k,"grab",function(b,e,c){c.style.zIndex=d.zIndex++})}if(g.closeOnBlur){voyc.addEvent(document.body,"keydown",function(){k.style.display="none"});voyc.addEvent(document.body,"mousedown",function(){k.style.display="none"})}this.cards[g.id]=k;return k};voyc.Card.prototype.destroy=function(b){var a=this.cards[b];a.parentNode.removeChild(a)};voyc.Card.prototype.show=function(b){var a=this.cards[b];a.style.display="block"};voyc.Card.prototype.hide=function(b){var a=this.cards[b];a.style.display="none"};voyc.Card.prototype.hideAll=function(){for(id in this.cards){this.hide(id)}};voyc.Card.prototype.destroyAll=function(){for(id in this.cards){this.destroy(id)}};voyc.Color=function(){if(arguments.callee._singletonInstance){return arguments.callee._singletonInstance}arguments.callee._singletonInstance=this;this.color=["#000000","#ff0000","#00ff00","#0000ff","#ffff00","#00ffff","#ff00ff","#ffffff"];this.pastel=["#000000","#ffcccc","#ccffcc","#ccccff","#ffffcc","#ccffff","#ffccff","#ffffff"];this.black=0;this.white=7;this.min=1;this.max=6;this.n=this.min;this.colornames={0:"black",1:"red",2:"green",3:"blue",4:"yellow",5:"cyan",6:"magenta",7:"white"}};voyc.Color.prototype.get=function(b){range=function(f,d,c){var e=Math.min(f,c);e=Math.max(f,d);return e};var a=range(b,this.min,this.max);return this.color[a]};voyc.Color.prototype.next=function(){this.n++;if(this.n>this.max){this.n=this.min}return this.n};voyc.Color.prototype.getPastel=function(b){range=function(f,d,c){var e=Math.min(f,c);e=Math.max(f,d);return e};var a=range(b,this.min,this.max);return this.pastel[a]};voyc.Cookie=function(){};voyc.Cookie.prefix="";voyc.Cookie.set=function(d,f,b,h,e,g){var a=voyc.Cookie.prefix+"_"+d;if(!b){var c=new Date();c.setTime(c.getTime()+180*24*60*60*1000);b=c}document.cookie=a+"="+escape(f)+((b)?"; expires="+b.toGMTString():"")+((h)?"; path="+h:"")+((e)?"; domain="+e:"")+((g)?"; secure":"")};voyc.Cookie.get=function(d){var a=voyc.Cookie.prefix+"_"+d;var c=document.cookie;var g=a+"=";var e=c.indexOf("; "+g);if(e==-1){e=c.indexOf(g);if(e!=0){return null}}else{e+=2}var b=document.cookie.indexOf(";",e);if(b==-1){b=c.length}var f=unescape(c.substring(e+g.length,b));if(f=="deletedcookie"){f=null}return f};voyc.Cookie.del=function(b,d,c){if(voyc.Cookie.get(b)){var a=voyc.Cookie.prefix+"_"+b;document.cookie=a+"=deletedcookie"+((d)?"; path="+d:"")+((c)?"; domain="+c:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"}};voyc.Debug=function(a){if(arguments.callee._singletonInstance){return arguments.callee._singletonInstance}arguments.callee._singletonInstance=this;this.defaultOptions={logSize:400,useConsole:true,div:null};this.options=voyc.mergeOptions(this.defaultOptions,a);this.log=[];this.indent=0;this.prevtime=new Date();this.starttime=new Date()};voyc.Debug.prototype={setOptions:function(a){this.options=voyc.mergeOptions(this.options,a)},post:function(a){this.log.push(a);if(this.log.length>this.options.logSize){this.log.shift()}},alert:function(g,f){var c=new Date();var a=c-this.prevtime;this.prevtime=c;var b=c-this.starttime;stime=voyc.pad(String(a),5);xtime=voyc.pad(String(b),5);var e=xtime+" "+stime+" "+g+"  ::"+voyc.getFileLine(f||3);this.post(e);if(this.options.div){var d="";for(m in this.log){d+=this.log[m]+"<br/>"}this.options.div.innerHTML=d}if(this.options.useConsole&&typeof window.console!="undefined"&&console.log){console.log(e)}},dumpElement:function(g){if(typeof(g)=="undefined"){this.alert("DumpElement: undefined");return}this.alert("DumpElement id="+g.id);if(g.hasAttributes){this.alert("attributes:");var b=g.attributes;var c=b.length;var f="";for(var d=0;d<c;d++){f=d+") "+b[d].name+" = "+b[d].value;this.alert(f)}}else{this.alert("attributes: none")}if(g.hasChildNodes()){this.alert("children:");var b=g.childNodes;var c=g.childNodes.length;var f="";for(var d=0;d<c;d++){f=d+") "+b[d].nodeName+" id="+b[d].id;this.alert(f)}}else{this.alert("children: none")}},dumpObject:function(a,b){this.maxdepth=b?b:10;this.dumpObjectR(a)},dumpObjectR:function(c){var b="";for(var a=0;a<this.indent;a++){b+="&nbsp;&nbsp;&nbsp;"}this.alert(b+"dumpObject: ");for(x in c){this.alert(b+x+"="+c[x]+" : "+typeof(c[x]));if(typeof(c[x])=="object"&&this.indent<this.maxdepth-1){this.indent++;this.dumpObjectR(c[x]);this.indent--}}}};voyc.Dragger=function(){if(arguments.callee._singletonInstance){return arguments.callee._singletonInstance}arguments.callee._singletonInstance=this;this.internaldiv=null;this.mousex=0;this.mousey=0;this.grabx=0;this.graby=0;this.orix=0;this.oriy=0;this.oriw=0;this.orih=0;this.elex=0;this.eley=0;this.algor=0;this.dragee=null;this.dragobj=null;this.savemousemove=null;this.savemouseup=null;this.savemousedown=null};voyc.Dragger.prototype={enableDrag:function(d,c){var b=this;var a=d;if(c){a=c;a.setAttribute("voycdragee",d.id)}a.onmousedown=function(e){b.grab(e,a)}},addListener:function(d,c,f){var b=this;var a=d;if(c=="grab"){a.ongrab=f}if(c=="drag"){a.ondrag=f}if(c=="drop"){a.ondrop=f}},getMouseXY:function(a){if(!a){a=window.event}if(a){if(a.pageX||a.pageY){this.mousex=a.pageX;this.mousey=a.pageY;this.algor="[e.pageX]";if(a.clientX||a.clientY){this.algor+=" [e.clientX] "}}else{if(a.clientX||a.clientY){this.mousex=a.clientX+document.body.scrollLeft;this.mousey=a.clientY+document.body.scrollTop;this.algor="[e.clientX]";if(a.pageX||a.pageY){this.algor+=" [e.pageX] "}}}}},move:function(a){this.getMouseXY(a);this.refreshInternals(a)},grab:function(d,b){this.getMouseXY(d);this.savemousedown=document.onmousedown;document.onmousedown=function(){return false};this.dragobj=b;var c=this.dragobj.getAttribute("voycdragee");this.dragee=(c)?document.getElementById(c):this.dragobj;this.savemousemove=document.onmousemove;var a=this;document.onmousemove=function(f){a.drag(f)};this.savemouseup=document.onmouseup;var a=this;document.onmouseup=function(){a.drop()};this.grabx=this.mousex;this.graby=this.mousey;this.elex=this.orix=this.dragee.offsetLeft;this.eley=this.oriy=this.dragee.offsetTop;this.oriw=this.dragee.offsetWidth;this.orih=this.dragee.offsetHeight;if(this.dragee.ongrab){ok=this.dragee.ongrab(this.elex,this.eley,this.dragee)}this.refreshInternals()},drag:function(b){this.getMouseXY(b);if(this.dragobj){this.elex=this.orix+(this.mousex-this.grabx);this.eley=this.oriy+(this.mousey-this.graby);var a={x:this.elex,y:this.eley};if(this.dragobj.ondrag){a=this.dragobj.ondrag(this.elex,this.eley)}if(a){this.dragee.style.left=a.x+"px";this.dragee.style.top=a.y+"px"}}this.refreshInternals(b);return false},drop:function(){if(this.dragobj){if(this.dragee.ondrop){this.dragee.ondrop(this.elex,this.eley,this.dragee)}this.dragobj=null}this.refreshInternals();document.onmousemove=this.savemousemove;document.onmouseup=this.savemouseup;document.onmousedown=this.savemousedown},setInternals:function(b){this.internaldiv=b;var a="<table><tr><td>parameter</td><td> value </td></tr><tr><td>navi.appName</td><td><span id='dragint_browser'>&nbsp;</span></td></tr><tr><td>window.event</td><td><span id='dragint_winevent'>&nbsp;</span></td></tr><tr><td>auto event</td><td><span id='dragint_autevent'>&nbsp;</span></td></tr><tr><td>algorithm</td><td><span id='dragint_algor'>&nbsp;</span></td></tr><tr><td>mousex,y</td><td><span id='dragint_mousex'>&nbsp;</span>, <span id='dragint_mousey'>&nbsp;</span></td></tr><tr><td>dragobj</td><td><span id='dragint_dragobj'>&nbsp;</span></td></tr><tr><td>grabx,y</td><td><span id='dragint_grabx'>&nbsp;</span>, <span id='dragint_graby'>&nbsp;</span></td></tr><tr><td>orix,y</td><td><span id='dragint_orix'>&nbsp;</span>, <span id='dragint_oriy'>&nbsp;</span></td></tr><tr><td>elex,y</td><td><span id='dragint_elex'>&nbsp;</span>, <span id='dragint_eley'>&nbsp;</span></td></tr></table>";if(this.internaldiv){this.internaldiv.innerHTML=a}},refreshInternals:function(a){if(!this.internaldiv){return}document.getElementById("dragint_winevent").innerHTML=window.event?window.event.type:"(na)";document.getElementById("dragint_autevent").innerHTML=a?a.type:"(na)";document.getElementById("dragint_mousex").innerHTML=this.mousex;document.getElementById("dragint_mousey").innerHTML=this.mousey;document.getElementById("dragint_grabx").innerHTML=this.grabx;document.getElementById("dragint_graby").innerHTML=this.graby;document.getElementById("dragint_orix").innerHTML=this.orix;document.getElementById("dragint_oriy").innerHTML=this.oriy;document.getElementById("dragint_elex").innerHTML=this.elex;document.getElementById("dragint_eley").innerHTML=this.eley;document.getElementById("dragint_algor").innerHTML=this.algor;document.getElementById("dragint_dragobj").innerHTML=this.dragobj?(this.dragobj.id?this.dragobj.id:"unnamed object"):"(null)"}};voyc.Event=function(){if(arguments.callee._singletonInstance){return arguments.callee._singletonInstance}arguments.callee._singletonInstance=this;this.events={};this.suspended=false};voyc.Event.prototype.subscribe=function(b,c,d,e){if(!this.events[b]){this.events[b]=[]}var a=(typeof e=="undefined")?true:e;this.events[b].push({subscriber:c,cb:d,alert:a})};voyc.Event.prototype.publish=function(a,d,e){if(!this.events[a]){return}if(this.suspended){return}e=e||{};var f=[];f.push(a);f.push(d);f.push(e);var c=this.events[a];for(var b in c){if(c[b].subscriber==d){if(c[b].alert){if(voyc.options.bEventLogging){voyc.debug.alert(["Event.publish",a,d,"ignored by publisher"],4)}}}else{if(c[b].alert){if(voyc.options.bEventLogging){voyc.debug.alert(["Event.publish",a,d,c[b].subscriber],4)}}c[b].cb.apply(this,f)}}};voyc.Event.prototype.suspend=function(a){this.suspended=a};voyc.cloneArray=function(b){var d=[];for(var c in b){d[c]=b[c]}return d};voyc.mergeOptions=function(d,b){var c={};if(d){for(var a in d){c[a]=d[a]}}if(b){for(var a in b){c[a]=b[a]}}return c};voyc.pad=function(c,e,d){c=String(c);e=parseInt(e)||2;var b=c;while(b.length<e){b="0"+b}if(d&&b.length>3){var a=b.length;b=b.substr(0,a-3)+","+b.substr(a-3)}return b};voyc.getAbsolutePosition=function(b){var a=0;var c=0;if(b.offsetParent){while(b.offsetParent){c+=b.offsetTop;a+=b.offsetLeft;b=b.offsetParent}}else{if(b.x){a+=b.x;c+=b.y}}return{x:a,y:c}};voyc.getFileLine=function(g){var n=g||2;var l="";var d=new Error();if(d.stack){var f=d.stack.split("\n");var j=f[n];var e=j.trim().split(/[ :]/);var k=e[4];var c=e[5];if(k&&c){var h=k.split("/");var b=h[h.length-1];l=b+"("+c+")"}}return l};voyc.$=function(a){return document.getElementById(a)};voyc.appendScript=function(b,c){var a=document.createElement("script");a.type="text/javascript";a.src=b;if(c){a.id=c}document.getElementsByTagName("head")[0].appendChild(a)};voyc.subClass=function(a,b){for(var c in b.prototype){if(!a.prototype[c]){a.prototype[c]=b.prototype[c]}}};voyc.addEvent=function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}}};voyc.hasClass=function(b,a){if(!b||!b.className){return false}return b.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))};voyc.addClass=function(b,a){if(!b){return false}if(!voyc.hasClass(b,a)){b.className+=" "+a}};voyc.removeClass=function(c,a){if(voyc.hasClass(c,a)){var b=new RegExp("(\\s|^)"+a+"(\\s|$)");c.className=c.className.replace(b," ")}};voyc.When=function(c,a,b){this.decidate=c||0;this.precision=a||voyc.When.precision.NONE;this.stdev=b||0};voyc.When.prototype={setDecidate:function(a){this.decidate=a},getDecidate:function(){return this.decidate},setPrecision:function(a){this.precision=a},getPrecision:function(){return this.precision},toString:function(){return String(this.serialize())},serialize:function(){return String(this.decidate)+"_"+this.precision+"_"+this.stdev},deserialize:function(c){var b=c.split("_");this.decidate=parseFloat(b[0]);this.precision=(b.length>0)?b[1]:voyc.When.precision.YEAR;this.stdev=(b.length>1)?parseInt(b[2]):0},format:function(k,a){var b={};var c=this.decidate>=0?+1:-1;var p=Math.floor(this.decidate);var l=Math.abs(p);if(l<100000){var h=voyc.When.toJSDate(this);b={dw:h.getDay(),dm:h.getDate(),m:h.getMonth(),y:h.getFullYear(),H:h.getHours(),M:h.getMinutes(),S:h.getSeconds(),N:h.getMilliseconds(),o:h.getTimezoneOffset()}}else{b={dw:0,dm:0,m:0,y:p,H:0,M:0,S:0,N:0,o:0}}var f={0:{sunit:"",lunit:"",y:"asis"},1000000:{sunit:"m",lunit:"Million",y:"unit"},1000000000:{sunit:"b",lunit:"Billion",y:"unit"},1000000000000:{sunit:"t",lunit:"Trillion",y:"unit"},1000000000000000:{sunit:"q",lunit:"Quadrillion",y:"unit"},1000000000000000000:{sunit:"",lunit:"",y:"exp"}};var o="";for(var g in f){if(l>=g){b.sunit=f[g].sunit;b.lunit=f[g].lunit;if(f[g].y=="exp"){o=Number(l).toExponential()}else{if(f[g].y=="unit"){o=l/g}else{if(f[g].y=="asis"){o=l}}}}}var n={0:{minus:"BC",plus:""},1000000:{minus:"Yrs Ago",plus:"Yrs From Now"},};for(var g in n){if(l>g){b.sign=c<0?n[g].minus:n[g].plus}if(l>g){b.sign=(c<0)?n[g].minus:n[g].plus}}var j="";if(this.precision==0.1){j=voyc.pad(b.N>9?Math.round(b.N/100):b.N,1)}else{if(this.precision==0.01){j=voyc.pad(b.N>99?Math.round(b.N/10):b.N,2)}else{j=voyc.pad(b.N,3)}}var e={dd:voyc.pad(b.dm),mmm:voyc.When.strings.i18n.monthNames[b.m],syyyy:p,yyyy:o,sunit:b.sunit,lunit:b.lunit,sign:b.sign,HH:voyc.pad(b.H),MM:voyc.pad(b.M),SS:voyc.pad(b.S),NN:j,zo:(b.o>0?"-":"+")+voyc.pad(Math.floor(Math.abs(b.o)/60)*100+Math.abs(b.o)%60,4)};var d={"default":"syyyy mmm dd HH:MM:SS.NN zo","lcd-second":"yyyy sign mmm dd, HH:MM:SS","lcd-minute":"yyyy sign mmm dd, HH:MM","lcd-day":"yyyy sign mmm dd","lcd-year":"yyyy lunit sign","ruler-year":"yyyy sunit","ruler-month":(b.m==0&&b.dm==1)?"yyyy sign":"mmm","ruler-day":(b.m==0&&b.dm==1)?"yyyy sign":"mmm dd","ruler-hour":(b.H==0)?"mmm dd":"HH:MM","ruler-minute":"HH:MM","ruler-hms":"HH:MM:SS","ruler-second":"MM:SS","ruler-msec":"SS.NN",none:"syyyy mmm dd HH:MM:SS.NN zo",1000:"yyyy sign",100:"yyyy sign",10:"yyyy sign",1:"yyyy sign",m:"yyyy sign mmm",d:"yyyy sign mmm dd",H:"mmm dd HH:MM",M:"HH:MM",S:"HH:MM:SS"};var k=d[k]||k||d[this.precision]||d["default"];var q=k;for(var g in e){q=q.replace(g,e[g])}return q}};voyc.When.strings={i18n:{monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}};voyc.When.fromJSDate=function(e){var b=e.valueOf();var d=e.getUTCFullYear();var a=Date.UTC(d,0,1);var h=b-a;var f=voyc.When.getMSperYear(d);var g=h/f;var c=d+g;return c};voyc.When.toJSDate=function(b){var d=Math.floor(b.decidate);var h=b.decidate-d;var e=voyc.When.getMSperYear(d);var g=Math.round(h*e);var a=Date.UTC(d,0,1);if(d>=0&&d<100){a-=Date.UTC(1898,0,1)-Date.UTC(-1,0,1)}var c=a+g;var f=new Date();f.setTime(c);return f};voyc.When.getMSperYear=function(a){if(voyc.When.isLeapYear(a)){return 31622400000}else{return 31536000000}};voyc.When.isLeapYear=function(c){c=parseInt(c);var a=1;var b=0;if(c%400==0){return a}if(c%100==0){return b}if(c%4==0){return a}return b};voyc.When.dd={0:{y:1,d:1/365,h:1/365/24,m:1/365/24/60,s:1/365/24/60/60,n:1/365/24/60/60/1000},1:{y:1,d:1/366,h:1/366/24,m:1/366/24/60,s:1/366/24/60/60,n:1/366/24/60/60/1000}};voyc.When.ms={0:{y:365*24*60*60*1000,d:24*60*60*1000,h:60*60*1000,m:60*1000,s:1000,n:1},1:{y:366*24*60*60*1000,d:24*60*60*1000,h:60*60*1000,m:60*1000,s:1000,n:1}};voyc.When.ddFromMS=function(e,d,c){var b=voyc.When.isLeapYear(c)?1:0;var a=voyc.When.dd[b][d]*e;return a};voyc.When.msFromDD=function(e,d,c){var a=voyc.When.isLeapYear(c)?1:0;var b=voyc.When.ms[a][d]*e;return b};voyc.When.precision={NONE:"none",MILLENIUM:1000,CENTURY:100,DECADE:10,YEAR:1,MONTH:"m",DAY:"d",HOUR:"H",MINUTE:"M",SECOND:"S",DECISECOND:0.1,CENTISECOND:0.01,MILLISECOND:0.001,NANOSECOND:0.0001};voyc.When.months={0:{name:"Jan",days:{0:31,1:31}},1:{name:"Feb",days:{0:28,1:29}},2:{name:"Mar",days:{0:31,1:31}},3:{name:"Apr",days:{0:30,1:30}},4:{name:"May",days:{0:31,1:31}},5:{name:"Jun",days:{0:30,1:30}},6:{name:"Jul",days:{0:31,1:31}},7:{name:"Aug",days:{0:31,1:31}},8:{name:"Sep",days:{0:30,1:30}},9:{name:"Oct",days:{0:31,1:31}},10:{name:"Nov",days:{0:30,1:30}},11:{name:"Dec",days:{0:31,1:31}}};voyc.When.getDaysInMonth=function(b,a){return voyc.When.months[a].days[voyc.When.isLeapYear(b)]};voyc.When.prototype.initPart=function(b){var c=voyc.When.toJSDate(this);var d=c.getFullYear();var a=c.getMonth();if(b){a=(a>0)?a-1:11}this.prec={1:{h:10,l:"m",min:-300000,max:300000},m:{h:1,l:"d",min:0,max:11},d:{h:"m",l:"H",min:1,max:voyc.When.getDaysInMonth(d,a)},H:{h:"d",l:"M",min:0,max:23},M:{h:"H",l:"S",min:0,max:59},S:{h:"M",l:0.1,min:0,max:59},0.1:{h:"S",l:0,min:0,max:9}};this.part={1:c.getFullYear(),m:c.getMonth(),d:c.getDate(),H:c.getHours(),M:c.getMinutes(),S:c.getSeconds(),N:c.getMilliseconds()}};voyc.When.prototype.zeroPart=function(){var b=this.precision;var a=this.prec[b];while(this.prec[a.l]){b=a.l;a=this.prec[b];this.part[b]=a.min}};voyc.When.prototype.nextPeriod=function(c){var c=c||1;var f=this.precision;if(voyc.When.isNumber(f)&&f>=1){var b=Math.floor(this.decidate);var e=(f*c);var b=Math.floor(b/e)*e;b+=(f*c);this.decidate=b;return}else{if(voyc.When.isNumber(f)&&f<1){this.initPart(false);if(f>0.001){var e=(f==0.01)?0.1:0.01;this.part.N=Math.floor(this.part.N*e)/e}var a=f*1000;this.part.N+=a;var d=0.1;while(this.part[d]>this.prec[d].max){this.part[d]=this.prec[d].min;f=this.prec[d].h;this.part[d]++}this.decidate=voyc.When.fromJSDate(new Date(this.part[1],this.part.m,this.part.d,this.part.H,this.part.M,this.part.S,this.part.N));return}else{this.initPart(false);this.part[f]++;if(c>1){while((((this.part[f]-this.prec[f].min)%c!=0)||((this.part[f]-this.prec[f].min)>(this.prec[f].max-(c*0.6))))&&(this.part[f]<=this.prec[f].max)){this.part[f]++}}while(this.part[f]>this.prec[f].max){this.part[f]=this.prec[f].min;f=this.prec[f].h;this.part[f]++}this.zeroPart();this.decidate=voyc.When.fromJSDate(new Date(this.part[1],this.part.m,this.part.d,this.part.H,this.part.M,this.part.S,this.part.N))}}};voyc.When.isNumber=function(a){return !isNaN(parseFloat(a))&&isFinite(a)};voyc.When.prototype.prevPeriod=function(e){var e=e||1;var h=this.precision;if(voyc.When.isNumber(h)&&h>=1){var d=Math.floor(this.decidate);var g=(h*e);var d=Math.floor(d/g)*g;if(d==this.decidate){d-=(h*e)}this.decidate=d;return}if(voyc.When.isNumber(h)&&h<1){this.initPart(true);var b=this.part.N;if(h>0.001){var g=(h==0.01)?0.1:0.01;this.part.N=Math.floor(this.part.N*g)/g}if(b==this.part.N){var c=h*1000;this.part.N-=c}var f=0.1;while(this.part[f]<this.prec[f].min){this.part[f]=this.prec[f].max;f=this.prec[f].h;this.part[f]--}this.decidate=voyc.When.fromJSDate(new Date(this.part[1],this.part.m,this.part.d,this.part.H,this.part.M,this.part.S,this.part.N));return}else{this.initPart(true);var a=this.prec[h].l;if(a&&this.part[a]>this.prec[a].min){this.part[a]=this.prec[a].min}else{this.part[h]--;var f=h;while(this.part[f]<this.prec[f].min){this.part[f]=this.prec[f].max;f=this.prec[f].h;this.part[f]--}}if(e>1){while((((this.part[h]-this.prec[h].min)%e!=0)||((this.part[h]-this.prec[h].min)>(this.prec[h].max-(e*0.6))))&&(this.part[h]>=this.prec[h].min)){this.part[h]--}}this.zeroPart();this.decidate=voyc.When.fromJSDate(new Date(this.part[1],this.part.m,this.part.d,this.part.H,this.part.M,this.part.S,this.part.N))}};voyc.JXmlHttp=function(){};voyc.JXmlHttp.create=function(){if(typeof ActiveXObject!="undefined"){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}if(typeof XMLHttpRequest!="undefined"){return new XMLHttpRequest()}return null};voyc.Xhr=function(){this.req=null;if(typeof ActiveXObject!="undefined"){try{this.req=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}if(typeof XMLHttpRequest!="undefined"){this.req=new XMLHttpRequest()}this.retries=0;this.maxretries=0;this.params={};this.data="";this.method="POST";this.program="";this.callback=null};voyc.Xhr.base="http://www.voyc.com/svc/";voyc.Xhr.prototype={callServer:function(){var c=this.composeParameters(this.params);var b=voyc.Xhr.base+this.program+c;var a=this;this.req.onreadystatechange=function(){a._callback()};this.req.open(this.method,b,true);this.req.onabort=function(){voyc.debug.alert("xhr in onabort")};this.req.onerror=function(){voyc.debug.alert("xhr in onerror")};this.req.ontimeout=function(){voyc.debug.alert("xhr in ontimeout")};this.req.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.req.send("data="+escape(this.data));voyc.debug.alert("xhr request sent: "+escape(this.data))},_callback:function(){if(this.req.readyState!=4){return}var b=true;try{if(this.req.status!=200&&this.req.status!=0){voyc.debug.alert("xhr callback status="+this.req.status);b=false}else{if(!this.req.responseText){voyc.debug.alert("xhr callback responseText is empty");b=false}}}catch(a){voyc.debug.alert("xhr caught callback error="+a);b=false}if(!b){if(this.retries<this.maxretries){voyc.debug.alert("xhr retrying");this.retries++;this.callServer()}else{if(this.callback){this.callback("server error "+this.req.status)}}}else{if(this.callback){voyc.debug.alert("xhr response received");this.callback(this.req.responseText,this.req)}}},composeParameters:function(d){var c="";var b="?";for(i in d){c+=b+i+"="+d[i];b="&"}return c}};