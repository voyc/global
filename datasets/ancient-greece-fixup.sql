/* select * from fpd.fpd where forebear = 6 */

/* datatype=8 Big Event, maptype=2 point*/

update fpd.fpd set
timebegin=-1250, timeend=-1260,
headline='The Trojan War', 
placename='Troy', 
the_geom=ST_GeomFromText('POINT(26.251667000 39.958611000)'),
abstract='The city of Troy, also known as Illium, is beseiged by an army of Acheans, led by the heroes Achilles and Ulysses, fighting for the honor of the beautiful Helen of Troy, culminating with the Trojan Horse subterfuge.  Written by Homer 400 years after the fact.',
tags='Homer,Illiad,Illium,Troy,Ullysses,Achilles,Trojan Horse'
where id = 14788;

update fpd.fpd set
headline='Greco-Persian Wars',
timebegin=-499, timeend=-449,
placename='Thermoplyae',
the_geom=ST_GeomFromText('POINT(38.798459500 22.545555600)'),
abstract='Fully documented by eye-witness Herodutus in his book "Histories".  Xerxes I of Persia attempts to annex Greece. An alliance of Greek city-states defend, led by Sparta, the pre-eminent military power at the time. Includes the Battle of Thermopolae in which 300 Spartans hold off the entire Persian army and prevent them from overrunning Greece.  Hollywood movies were made of this story in 1962 and 2007.',
tags='Herodotus,Xerxes I,Thermopylae,Persia,Spartans,Greco-Persian Wars'
where id = 14782;

update fpd.fpd set
timebegin=-431, timeend=-404, 
headline='Peloponnesian War',
abstract='Athens vs Sparta.  Written by Thucydides.  Sparta emerges victorious, though at great cost.',
placename='Athens and Sparta',
the_geom=ST_GeomFromText('LINESTRING(37.983917000 23.729359900,37.074461000 22.430264000)'),
tags='peloponnesian war, athens, sparta, thucydides'
where id=14784;

/* datatype=2 cultural boundaries, maptype=4 multipolygon*/

/* Classical, combine 18898 and 19019 */
update fpd.fpd
set the_geom=ST_GeomFromText('MULTIPOLYGON(((18.8727257258224 42.5166679060326,18.8704367258204 42.3175469058472,19.3657577262816 42.0451199055935,19.755949726645 41.5434449051263,19.4772407263854 40.5400929041919,20.2576257271121 39.2022919029459,21.2609767280467 38.4776489022711,21.7069107284619 37.3628139012328,22.264327728981 36.6939129006098,22.7211707294066 36.5670119004917,23.2581007299066 36.5397349004663,23.2119377298636 37.1398469010251,23.9365797305386 37.6415229014924,24.9399317314728 37.920231901752,23.4349047300714 39.6482259033612,23.1004537297597 40.3171259039841,23.4906457301231 39.9826759036728,24.4939977310576 40.2056429038803,24.5497397311096 40.8188019044514,25.8875407323555 41.041768904659,25.9432827324074 40.8188019044514,26.3892167328227 40.6515769042958,26.9466337333417 40.6515769042958,27.7270187340687 40.9860269046071,28.5689187348528 41.0912649047052,28.5966657348786 41.5180039051027,28.0057267343282 42.3238289058531,28.1009267344168 42.7998249062964,18.8771347258264 42.9002119063898,18.8727257258224 42.5166679060326)),((26.221991732667 39.2022919029459,26.4449587328745 38.5333909023229,27.2810847336534 37.3070729011808,28.2830357345865 36.6943799006103,28.529458734816 40.4843519041399,27.2810847336534 40.5400929041919,26.5006997329265 40.3171259039841,26.221991732667 39.9826759036728,26.221991732667 39.2022919029459)))'),
maptype=4
where id=18898;

/* Hellenic Age, combine 18899 and 19020 */
update fpd.fpd
set the_geom=ST_GeomFromText('MULTIPOLYGON(((18.8727257258224 42.5166679060326,18.8704367258204 42.3175469058472,19.3657577262816 42.0451199055935,19.755949726645 41.5434449051263,19.4772407263854 40.5400929041919,20.2576257271121 39.2022919029459,21.2609767280467 38.4776489022711,21.7069107284619 37.3628139012328,22.264327728981 36.6939129006098,22.7211707294066 36.5670119004917,23.2581007299066 36.5397349004663,23.2119377298636 37.1398469010251,23.9365797305386 37.6415229014924,24.9399317314728 37.920231901752,23.4349047300714 39.6482259033612,23.1004537297597 40.3171259039841,23.4906457301231 39.9826759036728,24.4939977310576 40.2056429038803,24.5497397311096 40.8188019044514,25.8875407323555 41.041768904659,25.9432827324074 40.8188019044514,26.3892167328227 40.6515769042958,26.9466337333417 40.6515769042958,27.7270187340687 40.9860269046071,28.5689187348528 41.0912649047052,28.5966657348786 41.5180039051027,28.0057267343282 42.3238289058531,28.1009267344168 42.7998249062964,18.8771347258264 42.9002119063898,18.8727257258224 42.5166679060326)),((26.221991732667 39.2022919029459,26.4449587328745 38.5333909023229,27.2810847336534 37.3070729011808,28.2830357345865 36.6943799006103,28.529458734816 40.4843519041399,27.2810847336534 40.5400929041919,26.5006997329265 40.3171259039841,26.221991732667 39.9826759036728,26.221991732667 39.2022919029459)))'),
maptype=4
where id=18899;

/* Hellenistic Age, combine 18895 and 19016 */
update fpd.fpd set
abstract='After Alexander''s sudden death, his empire was split a/moungst quarreling generals and family members.  Ptolemy took Egypt.  Selucus took much of Persia.  Splits and disintegration continued until the Romans came.  Scholars refer to this as the Hellenistic Era because regardless of the political chaos, Hellenistic thought and culture permeated and took root in all the areas of Alexander''s conquests.',
timebegin=-323, timeend=-31,
the_geom=ST_GeomFromText('MULTIPOLYGON(((18.8727257258224 42.5166679060326,18.8704367258204 42.3175469058472,19.3657577262816 42.0451199055935,19.755949726645 41.5434449051263,19.4772407263854 40.5400929041919,20.2576257271121 39.2022919029459,21.2609767280467 38.4776489022711,21.7069107284619 37.3628139012328,22.264327728981 36.6939129006098,22.7211707294066 36.5670119004917,23.2581007299066 36.5397349004663,23.2119377298636 37.1398469010251,23.9365797305386 37.6415229014924,24.9399317314728 37.920231901752,23.4349047300714 39.6482259033612,23.1004537297597 40.3171259039841,23.4906457301231 39.9826759036728,24.4939977310576 40.2056429038803,24.5497397311096 40.8188019044514,25.8875407323555 41.041768904659,25.9432827324074 40.8188019044514,26.3892167328227 40.6515769042958,26.9466337333417 40.6515769042958,27.7270187340687 40.9860269046071,28.5689187348528 41.0912649047052,28.5966657348786 41.5180039051027,28.0057267343282 42.3238289058531,28.1009267344168 42.7998249062964,18.8771347258264 42.9002119063898,18.8727257258224 42.5166679060326)),((26.221991732667 39.2022919029459,26.4449587328745 38.5333909023229,27.2810847336534 37.3070729011808,28.2830357345865 36.6943799006103,28.529458734816 40.4843519041399,27.2810847336534 40.5400929041919,26.5006997329265 40.3171259039841,26.221991732667 39.9826759036728,26.221991732667 39.2022919029459)))'),
maptype=4
where id = 18895;

/* Alexander 1, combine 18836,19055,18957 to 18836 */
update fpd.fpd set
the_geom=ST_GeomFromText('MULTIPOLYGON(((26.221991732667 39.2022919029459,26.4449587328745 38.5333909023229,27.2810847336534 37.3070729011808,27.9499857342762 36.8053969007137,28.6188867348992 36.582429900506,29.2320457354704 36.6381719005578,30.012429736197 36.1922379001426,30.6255887367681 36.3594629002982,30.68133073682 36.8053969007137,31.4617147375468 36.8611389007656,32.1306157381698 36.4709459004021,33.7471267396752 36.0250118999868,34.8062197406616 36.6939129006098,35.6423457414403 36.4709459004021,36.0882797418556 36.8053969007137,36.1997627419594 36.582429900506,35.809570741596 35.4675948994677,35.9767957417519 35.1331448991562,35.9767957417519 34.4642438985334,35.3078947411288 32.9592168971317,34.3602857402464 31.2869648955741,34.0258347399349 31.1197388954185,33.3569337393119 31.2869648955741,32.7995167387928 31.1197388954185,32.5765497385851 30.8410308951588,32.8186007388106 30.1874918945502,35.2433067410686 30.8070008951272,37.2413797429294 31.0653268953679,38.6520397442434 32.6733668968654,38.9655157445352 32.6733668968654,39.1222567446812 32.8341708970152,41.0031357464329 32.8341708970152,42.2570527476007 32.1909558964162,43.9811897492066 30.4221098947687,45.2351067503744 29.4572878938702,45.5485887506663 29.4572878938702,46.4890297515421 28.814070893271,47.7429477527098 28.4924618929715,48.6833837535858 28.0100498925224,49.071195753947 27.9950868925084,48.6859127535881 28.7228448931862,48.072753753017 29.3917448938091,49.2433297541072 30.4508388947954,49.6892637545225 30.116387894484,50.3581647551455 29.9491628943283,51.6402247563394 27.9982018925114,52.5320927571702 27.6080098921479,53.3682187579489 26.9391088915249,54.8175037592987 26.4374328910578,55.6536297600774 26.6603998912653,56.3225307607001 27.1620758917327,57.0471737613752 26.7718838913693,57.3258817616347 25.9914988906423,58.1620087624135 25.4898238901751,59.1653597633479 25.3225978900196,60.6703867647495 25.3225978900196,61.0048367650611 25.0438898897598,63.4866107673724 25.1949628899006,64.8405657686333 25.0595668897745,66.234108769931 25.2337598899367,67.1050737707424 25.0595668897745,67.6712967712697 24.2416888890127,68.4825637720251 25.8826508905411,68.3517437719033 26.9254508915121,68.8376437723559 27.4468508919979,68.9155917724286 27.8416938923656,69.4077587728868 28.3137768928052,70.1236377735536 28.5760458930495,70.6605467740535 29.1005828935379,70.8395167742203 31.6183598958828,71.6001377749287 33.0346098972018,73.0766377763036 34.8180358988627,73.7477747769287 36.7588229006703,74.3294257774705 37.5980819014519,74.1848627773359 38.4160009022137,72.8198797760647 39.9170009036116,70.9674047743395 40.8650009044945,68.1399417717062 42.0500009055982,66.0924687697993 42.603000906113,65.5074757692544 42.9190009064073,62.777511766712 43.551000906996,61.7050257657131 44.0250009074375,58.4875677627167 43.7880009072167,57.0250867613545 42.5240009060394,56.830089761173 42.2080009057452,56.8286747611717 41.788000905354,55.4594537598964 40.5240009041768,54.5734877590714 39.0230009027789,54.1707757586962 38.7070009024847,52.3988417570461 38.3910009021904,48.9968647538776 38.6231169024065,48.9968647538776 38.7839209025562,48.6833837535858 38.7839209025562,48.5266457534399 38.944724902706,47.8996847528558 38.944724902706,46.4890297515421 39.587940903305,45.2351067503744 39.7487449034547,44.7648887499363 40.0703519037543,44.1379317493524 40.0703519037543,43.3542337486226 40.3919599040539,42.7272717480387 40.3919599040539,42.5705347478927 40.5527659042036,41.4733547468709 40.5527659042036,41.0819237465064 41.1203759047323,40.324651745801 40.9302859045551,38.4294327440359 40.9302859045551,35.0849277409211 41.8221529053858,32.9667417389485 41.9893789055416,31.6289397377025 41.097510904711,29.4550127356779 41.2089939048149,29.0648197353146 40.9860269046071,29.4550127356779 40.8188019044514,29.2320457354704 40.5400929041919,27.2810847336534 40.5400929041919,26.5006997329265 40.3171259039841,26.221991732667 39.9826759036728,26.221991732667 39.2022919029459)),((24.2895377308671 31.1230008954215,24.3700797309423 30.8070008951272,28.0750317343927 28.1210008926257,28.7999137350678 27.33100089189,29.444252735668 26.0670008907127,30.249676736418 25.5140008901976,32.7464917387433 24.8820008896091,35.0935977409292 24.9305168896542,34.4515967403313 26.1431868907837,33.950729739865 27.5623108921054,32.9250097389097 28.9928158934376,32.9250097389097 29.4964218939067,32.1108297381513 31.1300378954281,28.9558837352131 30.8247198951437,26.5133437329382 31.1300378954281,25.292074731801 31.8424448960916,24.2895377308671 31.9092808961539,24.2895377308671 31.1230008954215)),((20.0000007268723 40.8718899045009,20.4609277273016 39.9861149036758,20.904864727715 40.0250039037121,21.2463547280331 39.4416709031689,21.9976317287328 39.4416709031689,22.1000787288281 39.8305599035311,22.5098667292098 39.8305599035311,23.2611447299093 38.9750039027342,23.7377087303532 39.2755429030142,23.1004537297597 40.3171259039841,23.4906457301231 39.9826759036728,24.4939977310576 40.2056429038803,24.5497397311096 40.8188019044514,25.8875407323555 41.041768904659,25.9432827324074 40.8188019044514,26.3892167328227 40.6515769042958,26.9466337333417 40.6515769042958,27.7270187340687 40.9860269046071,28.6188867348992 41.097510904711,28.6188867348992 41.4877029050745,28.0057267343282 42.3238289058531,28.1172107344321 42.8812459063722,28.6188867348992 43.3829219068393,29.3435287355742 44.6649819080335,29.7238547359284 44.950227908299,29.3320747355635 45.4611109087748,28.4290237347225 45.4611109087748,28.3000167346022 45.3166669086404,28.3000167346022 44.5944449079677,28.1065057344219 44.3055559076986,23.4622447300967 42.4999999060171,21.5271357282945 42.2833339058154,20.6999707275243 41.7361149053056,20.5975237274288 41.3472259049436,20.0852887269516 41.3861149049796,19.9145437267928 41.0361149046537,20.0000007268723 40.8718899045009)))
'),
maptype=4
where id = 18836;

/* Alexander 2, combine 19051,18943,18822 to 19051 */
update fpd.fpd set
the_geom=ST_GeomFromText('MULTIPOLYGON(((26.221991732667 39.2022919029459,26.4449587328745 38.5333909023229,27.2810847336534 37.3070729011808,27.9499857342762 36.8053969007137,28.6188867348992 36.582429900506,29.2320457354704 36.6381719005578,30.012429736197 36.1922379001426,30.6255887367681 36.3594629002982,30.68133073682 36.8053969007137,31.4617147375468 36.8611389007656,32.1306157381698 36.4709459004021,33.7471267396752 36.0250118999868,34.8062197406616 36.6939129006098,35.6423457414403 36.4709459004021,36.0882797418556 36.8053969007137,36.1997627419594 36.582429900506,35.809570741596 35.4675948994677,35.9767957417519 35.1331448991562,35.9767957417519 34.4642438985334,35.3078947411288 32.9592168971317,34.3602857402464 31.2869648955741,34.0258347399349 31.1197388954185,33.3569337393119 31.2869648955741,32.7995167387928 31.1197388954185,32.5765497385851 30.8410308951588,32.8186007388106 30.1874918945502,35.2433067410686 30.8070008951272,37.2413797429294 31.0653268953679,38.6520397442434 32.6733668968654,38.9655157445352 32.6733668968654,39.1222567446812 32.8341708970152,41.0031357464329 32.8341708970152,42.2570527476007 32.1909558964162,43.9811897492066 30.4221098947687,45.2351067503744 29.4572878938702,45.5485887506663 29.4572878938702,46.4890297515421 28.814070893271,47.7429477527098 28.4924618929715,48.6833837535858 28.0100498925224,49.071195753947 27.9950868925084,48.6859127535881 28.7228448931862,48.072753753017 29.3917448938091,49.2433297541072 30.4508388947954,49.6892637545225 30.116387894484,50.3581647551455 29.9491628943283,51.6402247563394 27.9982018925114,52.5320927571702 27.6080098921479,53.3682187579489 26.9391088915249,54.8175037592987 26.4374328910578,55.6536297600774 26.6603998912653,56.3225307607001 27.1620758917327,57.0471737613752 26.7718838913693,57.3258817616347 25.9914988906423,58.1620087624135 25.4898238901751,59.1653597633479 25.3225978900196,60.6703867647495 25.3225978900196,61.0048367650611 25.0438898897598,63.4866107673724 25.1949628899006,64.8405657686333 25.0595668897745,66.234108769931 25.2337598899367,67.1050737707424 25.0595668897745,67.6712967712697 24.2416888890127,68.4825637720251 25.8826508905411,68.3517437719033 26.9254508915121,68.5760057721122 27.2947758918563,69.699920773159 27.9880008925018,71.4548977747934 28.5410008930169,73.0148777762463 29.4890008938996,75.0623507781531 30.2790008946354,75.5498447786072 30.6740008950032,75.8423407788796 31.6220008958862,75.8423407788796 35.3350008993443,74.4773587776083 38.0210009018458,72.8198797760647 39.9170009036116,69.0174297725232 41.7340009053037,66.0924687697993 42.603000906113,65.5074757692544 42.9190009064073,62.777511766712 43.551000906996,61.7050257657131 44.0250009074375,58.4875677627167 43.7880009072167,57.0250867613545 42.5240009060394,56.830089761173 42.2080009057452,56.8286747611717 41.788000905354,55.4594537598964 40.5240009041768,54.5734877590714 39.0230009027789,54.1707757586962 38.7070009024847,52.3988417570461 38.3910009021904,48.9968647538776 38.6231169024065,48.9968647538776 38.7839209025562,48.6833837535858 38.7839209025562,48.5266457534399 38.944724902706,47.8996847528558 38.944724902706,46.4890297515421 39.587940903305,45.2351067503744 39.7487449034547,44.7648887499363 40.0703519037543,44.1379317493524 40.0703519037543,43.3542337486226 40.3919599040539,42.7272717480387 40.3919599040539,42.5705347478927 40.5527659042036,41.4733547468709 40.5527659042036,41.0819237465064 41.1203759047323,40.324651745801 40.9302859045551,38.4294327440359 40.9302859045551,35.0849277409211 41.8221529053858,32.9667417389485 41.9893789055416,31.6289397377025 41.097510904711,29.4550127356779 41.2089939048149,29.0648197353146 40.9860269046071,29.4550127356779 40.8188019044514,29.2320457354704 40.5400929041919,27.2810847336534 40.5400929041919,26.5006997329265 40.3171259039841,26.221991732667 39.9826759036728,26.221991732667 39.2022919029459)),((20.0000007268723 40.8718899045009,20.4609277273016 39.9861149036758,20.904864727715 40.0250039037121,21.2463547280331 39.4416709031689,21.9976317287328 39.4416709031689,22.1000787288281 39.8305599035311,22.5098667292098 39.8305599035311,23.2611447299093 38.9750039027342,23.7377087303532 39.2755429030142,23.1004537297597 40.3171259039841,23.4906457301231 39.9826759036728,24.4939977310576 40.2056429038803,24.5497397311096 40.8188019044514,25.8875407323555 41.041768904659,25.9432827324074 40.8188019044514,26.3892167328227 40.6515769042958,26.9466337333417 40.6515769042958,27.7270187340687 40.9860269046071,28.6188867348992 41.097510904711,28.6188867348992 41.4877029050745,28.0057267343282 42.3238289058531,28.1172107344321 42.8812459063722,28.6188867348992 43.3829219068393,29.3435287355742 44.6649819080335,29.7238547359284 44.950227908299,29.3320747355635 45.4611109087748,28.4290237347225 45.4611109087748,28.3000167346022 45.3166669086404,28.3000167346022 44.5944449079677,28.1065057344219 44.3055559076986,23.4622447300967 42.4999999060171,21.5271357282945 42.2833339058154,20.6999707275243 41.7361149053056,20.5975237274288 41.3472259049436,20.0852887269516 41.3861149049796,19.9145437267928 41.0361149046537,20.0000007268723 40.8718899045009)),((24.2895377308671 31.1230008954215,24.3700797309423 30.8070008951272,28.0750317343927 28.1210008926257,28.7999137350678 27.33100089189,29.444252735668 26.0670008907127,30.249676736418 25.5140008901976,32.7464917387433 24.8820008896091,35.0935977409292 24.9305168896542,34.4515967403313 26.1431868907837,33.950729739865 27.5623108921054,32.9250097389097 28.9928158934376,32.9250097389097 29.4964218939067,32.1108297381513 31.1300378954281,28.9558837352131 30.8247198951437,26.5133437329382 31.1300378954281,25.292074731801 31.8424448960916,24.2895377308671 31.9092808961539,24.2895377308671 31.1230008954215)))
'),
maptype=4
where id = 19051;

/* datatype=5 person, maptype=2 point*/

/*alexander the great, maptype=point,timetype=bar*/
update fpd.fpd set
placename='Pella, Macedon',
datatype=2,
the_geom=ST_GeomFromText('POINT(40.763243600 22.526052700)'),
abstract='Born in Pella in Macedon as the son of Phillip, the King of Macedon.  After Phillip was assassinated, Alexander succeeded to his father''s throne at age 20 and immediately began his conquests.  Ten years later the brilliant military commander had conquered all of Greece, Egypt and the entire Persion Empire, stopped finally at the Indus River by Hannibal''s elephant cavalry.  While the world was absorbing Hellenic culture, Alexander himself adopted Persian dress and manners, and took up residence in Nebuchanezzar''s palace in Babylon, where he was poisoned to death at the age of 33.',
tags='conquerer,Alexander,Phillip,Persia,Greece,Hellenistic'
where id=13880;

/* datatype=2 cultural boundaries, maptype=3 polygon*/

/* upper timeline level */
update fpd.fpd set color=4,timelvllo=7,timelvlhi=7 where id = 6;

/* Dorians */
update fpd.fpd set timebegin=-1210 where id = 13645;

/* modern Greece datatype=3*/
update fpd.fpd set timebegin=1828 where id = 18835;

/* all deletions, 31 rows */
delete from fpd.fpd where id in (21337,14424,19029,19030,19017,14789,18896,19028,19080,
19018,18897,14790,19031,18906,13911,19079,19027,14792,14791,18956,19054,
19020,19019,19016,14786,19022,18901,19055,18957,18943,18822);

/* final updates, 42 rows */
update fpd.fpd set 
editstatus=0,
permalink=trim(both '-' from lower(regexp_replace(headline, '[\ \~\!\'\"\”\“\‘\?\.\@\#\$\%\^\&\*\(\)\{\}\[\\]\,\/\<\>\;\:]+', '-', 'g'))),
fulltext=lower(' ' || replace(case when tags isnull then '' else tags end, ',', ' ') || ' ' || case when author isnull then '' else author end || ' ' || case when headline isnull then '' else headline end || ' ' || case when abstract isnull then '' else abstract end || ' ')
where forebear = 6;

update fpd.fpd set tsfulltext = to_tsvector(fulltext)
where forebear = 6;

/* additional fixup during test */

update fpd.fpd set timebegin=-450, timeend=-336 where id=18898;

update fpd.fpd set timebegin=-334, timeend=-325 where id=18836;

update fpd.fpd set forebear=6,timelvlhi=6
where id in (14782,14784,14788);

update fpd.fpd set color=4, datatype=8
where id in (14782,14784,14788)

update fpd.fpd set timebegin=-1194, timeend=-1184
where id = 14788;

select id,headline,maptype,astext(the_geom)
from fpd.fpd
where id in (14782,14784,14788)

update fpd.fpd set the_geom=ST_GeomFromText('POINT(22.430264000 37.074461000)')
where id =14784

update fpd.fpd set the_geom=ST_GeomFromText('POINT(22.545555600 38.798459500)')
where id = 14782;

update fpd.fpd set maptype=2
where id in (14782,14784,14788)

update fpd.fpd set datatype=8, the_geom=ST_GeomFromText('POINT(22.5260527 40.7632436)')
where id=13880;



select id,headline,datatype,forebear,parent,color,editstatus,magnitude,
maptype,maplvllo,maplvlhi,placename,
timetype,timebegin,timeend,timelvllo,timelvlhi,
storyurl,imageurl,thumburl,
timeprecision,version,service,guid,feeling,userid,author,bibid,
tags,abstract,
astext(the_geom),
tm,
permalink,fulltext,tsfulltext
from fpd.fpd
where forebear=6
order by timebegin;
