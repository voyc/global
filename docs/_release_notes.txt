Release Notes

17 Aug 2014
Insert some of india.sql.

6 Aug 2014
Insert Spain, Algeria, Great Britain, Kingdom of Ireland.

3 Aug 2014
Fix Iraq.
update fpd.fpd set the_geom = GeomFromText('POLYGON((45.4206181170532 35.9775458847428,46.0763403664048 35.6773833277755,46.1517879575509 35.0932587753643,45.6484595070281 34.748137722303,45.416690708199 33.9677977564796,46.1093616066393 33.017287299119,47.3346614927119 32.4691553817991,47.8492037290421 31.7091759302987,47.6852860858123 30.9848532170796,48.0046981138083 30.9851374374572,48.0145683123761 30.4524567733926,48.5679712257898 29.9267782659035,47.9745190773499 29.9758192001485,47.302622104691 30.0590699325707,46.5687134132818 29.0990251734523,44.7094987322847 29.1788910995594,41.8899809100078 31.1900086532784,40.3999943377362 31.8899917668879,39.195468377445 32.1610088160427,38.7923405291361 33.3786864283522,41.0061588885199 34.4193722600621,41.3839652850058 35.6283165553144,41.2897074725055 36.3588146021923,41.837064243341 36.6058537867636,42.3495910988118 37.2298725449041,42.7791256040218 37.3852635768058,43.9422587420473 37.2562275253729,44.2934517759029 37.0015143906063,44.7726990089777 37.1704446477684,45.4206181170532 35.9775458847428))')
where id = 10416
Delete erroneous Bulgaria record.
delete from fpd.fpd where id = 10385
Fix France.
update fpd.fpd set abstract='',author='JGHAGSTR',bibid='NED',maptype=4,parent=10364,timebegin=1650,
the_geom=GeomFromText('MULTIPOLYGON(((-52.5564247300184 2.50470530843705,-52.939657151895 2.12485769287562,-53.4184651352953 2.05338918701604,-53.5548392401135 2.33489655192597,-53.7785206772889 2.37670278565005,-54.0880625067173 2.10555654541463,-54.5247541977998 2.31184886312379,-54.2712296209758 2.73874787028694,-54.1842840236448 3.19417226807523,-54.0115038722768 3.62256989177486,-54.3995422023565 4.21261139568348,-54.4786329819792 4.89675568279564,-53.9580446030709 5.75654816326781,-53.6184529282648 5.6465290389184,-52.8821412827541 5.4098509790216,-51.8233428615259 4.56576813396615,-51.6577974106789 4.15623240805303,-52.249337531124 3.24109446859629,-52.5564247300184 2.50470530843705)),((9.56001631026913 42.1524919703796,9.22975223149177 41.3800068222644,8.77572309737536 41.5836119654944,8.54421268070783 42.2565166285831,8.74600914880759 42.628121853194,9.3900008480289 43.0099848496147,9.56001631026913 42.1524919703796)),((3.58818444175571 50.3789924180036,4.28602298342514 49.9074966497726,4.79922163251575 49.9853730332363,5.67405195478489 49.5294835475574,5.89775923017638 49.4426671413072,6.18632042809421 49.4638028021145,6.65822960778354 49.2019583196916,8.09927859867477 49.0177835150034,7.59367638513106 48.3330191107037,7.46675906742223 47.6205819769119,7.19220218265554 47.449765529971,6.73657107913809 47.5418012558829,6.76871382002363 47.2877082383037,6.03738895022897 46.7257787135619,6.02260949059357 46.2729898138205,6.50009972497045 46.4296727565294,6.84359297041456 45.9911465521007,6.80235517744566 45.7085798203287,7.09665245934784 45.3330988632959,6.74995527510171 45.0285179713676,7.00756229007666 44.2547667506614,7.54959638838616 44.1279011093848,7.43518476729184 43.6938449163492,6.52924523278307 43.1288923203184,4.5569625179314 43.3996509873116,3.10041059735272 43.0752005071671,2.98599897625849 42.4730150416699,1.82679324708718 42.3433847112657,0.701590610363922 42.7957343613326,0.338046909190581 42.5795460068396,-1.50277096191047 43.0340143906305,-1.90135128417774 43.4228020289783,-1.38422522623296 44.0226103785902,-1.19379757323736 46.0149177109549,-2.22572424967379 47.0643626979382,-2.96327612955957 47.570326646508,-4.49155493815948 47.9549543320564,-4.59234981934475 48.6841604681269,-3.29581397135775 48.9016924098596,-1.61651078938493 48.6444212916946,-1.93349402506325 49.7763418646158,-0.98946895995536 49.3473758001609,1.33876102052275 50.1271731634453,1.6390010921385 50.9466063502975,2.51357303224617 51.1485061712619,2.65842207196033 50.7968480495157,3.12325158042572 50.7803632676145,3.58818444175571 50.3789924180036)))', -1)
where id = 10364


21 Jul 2014
Fix X7 to Phrygia.  9 rows affected
update fpd.fpd set headline='Phrygia',color=3 where lower(headline) = 'x7'

20 Jul 2014
Change datatypes.  Defined in timeline.js
update fpd.fpd set datatype=5, forebear=6 where id in (14679,14691,14690,14678)
update fpd.fpd set datatype=5, forebear=6, magnitude=900 where id in (14681)
update fpd.fpd set datatype=5, forebear=6, magnitude=500 where id in (14685,14693,14692,14694,14683,14682,14686,14689,14684,14695,14688,14680,14783,14696,14687)
update fpd.fpd set datatype=5 where bibid = 'amg'; /* musicians 71 rows */
Change maptype codes.  Defined in map.js
update fpd.fpd set maptype=3 where maptype=2; /* 685 rows */
update fpd.fpd set maptype=2 where maptype=5; /* 109843 rows */
Fix Greece.  SQL in datasets/ancient-greece.sql

16 Jul 2014
Updated timeline drawing algorithms for row vs stream.

15 Jul 2014
Commented out the limit clause on the sql query.
Fix Medes.
update fpd.fpd set color=5 where id=13831;
update fpd.fpd set timeend = -540, color=5 where id=13847;
delete from fpd.fpd where id=13862;
Fix Etruscans.
update fpd.fpd set color=5, timebegin=-520 where id=14481;
delete from fpd.fpd where id = 14479;

12 Jul 2014
Zero unnecessary forebear values.
Keep only those where forebear in (3,5,6,10248,10298,10364,10377,10379,10385,10389,10394,10404,10416,10435,10438,10464,10506,10540,10572,10630,10646,11344,11346,11368,11378,13283,13285,13300,13332,13335,13336,13346,13361,13375,13416,13502,13550,13576,13665,13781,13824,13904,13908,13919,13964,14007,14010,14011,14088,14111,14129,14145,14191,14315,14428,14432,14440,14479,14513,14536,14537,14538,14539,14540,14541,14542,14543,14544,14545,14681,14776,14811,14816,14835,14839,14843,14845,14856,14879,14880,14882,14883,14894,14898,14903,14909)
update fpd.fpd set forebear = 0 where datatype = 11 and id < 600000
162484 rows affected
update fpd.fpd set forebear = 0 where datatype = 11 and id >= 600000
116876 rows affected
update fpd.fpd set forebear = 0
where forebear not in (0,3,5,6,10248,10298,10364,10377,10379,10385,10389,10394,10404,10416,10435,10438,10464,10506,10540,10572,10630,10646,11344,11346,11368,11378,13283,13285,13300,13332,13335,13336,13346,13361,13375,13416,13502,13550,13576,13665,13781,13824,13904,13908,13919,13964,14007,14010,14011,14088,14111,14129,14145,14191,14315,14428,14432,14440,14479,14513,14536,14537,14538,14539,14540,14541,14542,14543,14544,14545,14681,14776,14811,14816,14835,14839,14843,14845,14856,14879,14880,14882,14883,14894,14898,14903,14909)
217 rows affected

9 Jul 2014
Fix maptype.  133 point records have maptype 2 instead of 5.
update fpd.fpd set maptype = 5 where geometrytype(the_geom) = 'POINT' and maptype <> 5
133 rows affected: 14739,14712,14792,11344,14710,14709,14909,14759,14743,13332,14129,13502,10389,13550,14010,14786,10572,14879,10646,13908,11346,11378,3,14791,14749,14753,14741,14748,5,14697,14742,14754,14746,14745,14737,968494,968511,14685,14678,14693,14692,14679,14694,14683,14682,14145,14719,14790,14433,14736,14738,14721,14723,14724,14435,14728,14647,14729,14711,14718,14740,14789,14444,13880,14722,14731,14735,14717,14733,14734,14423,14422,14758,14756,14725,968501,14720,968507,968508,968510,14713,14732,968515,968516,14686,14689,14681,14684,14695,14688,14680,14690,14783,14691,14696,14687,14432,11368,14730,10364,14752,14751,13416,14755,14747,14750,14652,13576,14646,13904,14440,13336,13335,13964,14428,14645,10248,10439,14903,14744,14757,14088,10394,10298,14816,14421,13911,14011,14699,968493,968502,968503,968513

8 Jul 2014
Reinstate maplevel and timelevel into where clause.
Separate Bulgarian Empire and Bulgaria at 1396. 
update fpd.fpd set timebegin = 1396 where id = 10385
update fpd.fpd set timeend = 1396 where id = 14810

6 Jul 2014
Clean maptype, timetype, editstatus, datatype.
update fpd.fpd set maptype = 2 where maptype = 6 and st_npoints(the_geom) > 5
4 rows affected: 21337,6,1,18900
update fpd.fpd set maptype = 2, the_geom = st_makepoint(xmin(the_geom)+((xmax(the_geom) - xmin(the_geom))/2),ymin(the_geom)+((ymax(the_geom) - ymin(the_geom))/2)) where maptype = 6
133 rows affected: 14737,968493,968494,968502,968511,968503,968513,14685,14678,14693,14692,14679,14694,14683,14682,14428,14145,14719,14790,14433,14736,14738,14721,14723,14724,14435,14728,14647,14729,14711,14718,14739,14712,14740,14789,14444,13880,14722,14731,14735,14717,14733,14734,14792,14423,14422,14758,14756,14725,968501,14720,968507,968508,968510,14713,14732,968515,968516,14686,14689,14681,14684,14695,14688,14680,14690,14783,14691,14696,14687,14432,10248,10439,11368,14730,14903,10364,14752,14645,14751,13416,14755,14747,14750,14652,13576,14646,14744,11344,13904,14710,14440,14709,14909,14757,14759,14743,13332,14129,14088,13502,13336,10389,13335,13550,10394,14010,10298,14786,14816,14421,10572,14879,10646,13911,13908,11346,14011,11378,13964,3,14791,14749,14753,14741,14748,5,14697,14742,14754,14746,14745,14699
update fpd.fpd set timetype = 2 where timetype = 0
5 rows affected: 34250,34350,34238,34251,34252
delete from fpd.fpd where id = 34238
update fpd.fpd set editstatus = 2 where editstatus = 1
91 rows affected:13709,13737,13913,18860,13391,14473,13340,13590,13623,13637,13339,18918,13597,13688,13684,13636,13354,13643,13626,13649,13614,13564,13631,13509,13621,13666,13567,13587,13912,13991,13816,13682,13702,13374,14484,13863,18981,19052,13700,13619,13693,13341,14002,14483,13711,13853,13771,13431,19104,13817,19085,13455,19098,13886,13625,18944,14004,13440,13447,13355,13539,19043,18941,19050,19089,13596,13561,13602,13599,13530,13606,13571,13620,13632,13604,13748,13758,13762,14475,13920,13997,14493,13904,14440,13336,13335,13964,14428,14645,13576,14646
update fpd.fpd set editstatus = 1 where editstatus = 11
6 rows affected:222055,223924,223929,223978,223979,35247
update fpd.fpd set maptype = 0 where the_geom is null
170805 rows affected

5 Jul 2014
Add background rows vs foreground streams to timeline.
Change timetype 3 to 1.
update fpd.fpd set timetype = 3 where timetype = 1
104 rows affected
14777,14428,14145,14730,14719,14790,14645,14827,14776,14111,14828,14433,14736,14738,14721,14723,14724,14652,14435,14646,14728,14647,14729,14710,14711,14718,14709,14739,14712,14740,13332,14788,14129,14789,14444,13880,14845,14786,14421,14722,14731,14735,13964,14717,14733,14734,14778,14824,14775,14823,14781,14791,14792,14423,14422,14779,14780,14697,14742,14782,14787,14758,14756,14699,14737,968493,968494,14725,968501,14720,968507,968508,968510,14713,14732,968515,968502,968511,968516,968503,968513,14685,14686,14689,14681,14678,14693,14692,14679,14694,14683,14684,14695,14688,14680,14690,14783,14691,14696,14784,14682,14687,21337,14432

13 June 2014
Complete rewrite.  
Support GMap v3.  
New inhouse Timeline replacing MIT Simile.

30 Apr 2014
China data changed
update fpd.fpd set timetype=3
  where id in (14497,14503,15008,14500,5)	
delete fpd.fpd
  where id in (14494,14498,14499,14501,14502,14504,14863)

27 July 2013
Errors in json returned from svc/search.
In search.php, added the "and the_geom is not null" to the where clause.
Also fixed two fpd records in ripening oranges series.

18 July 2013
Fixed seo files: contributors, stories, tags.  Added required include files.

18 July 2013
After clicking a dot on map and timeline, it leaves down state on mouseoff.  
Uncommented 3 lines in coordinates.js.

10 July 2013 
javascript error:
Uncaught SyntaxError: Unexpected token , svc/get?rf=1373446235421&id=955593&token=:1
value for field v was null
update existing records:
	update existing records
		update fpd.fpd set version = 0 where version is null
	alter column version in table fpd.fpd
		set to not null default 0

10 Jul 2013
more recent reuters images not found
update 8462 existing records
	update fpd.fpd set imageurl = substring(imageurl,23)
	where imageurl like 'http://www.reuters.comhttp%'
change translateFeed.php
	comment this line $img = "http://www.reuters.com" . stripslashes($img);
	this prefix is no longer necessary
